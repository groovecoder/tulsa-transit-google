#!/usr/bin/env python
'''Parse a trapeze text file'''

import re

def parse_trapeze_text(text):
    '''Parse a trapeze file'''
    if text.startswith('Stop Trips'):
        return parse_trapeze_stop_trips(text)
    else:
        raise ValueError('Unknown Trapeze text dump')

def parse_trapeze_stop_trips(text):
    '''Parse a trapeze Stop Trips file'''
    in_header = False
    header_done = False
    in_direction = False
    dir_headers = None
    dir_rows = None
    d = dict(meta=dict(),direction=dict())
    for linenum, line in enumerate(text.split('\n')):
        if in_header:
            if ':' in line:
                name, raw_val = line.split(':',1)
                val = raw_val.strip()
                d['meta'][name] = val
            elif line == '':
                in_header = False
            else:
                raise ValueError('Header failure at line ' + linenum + '\n' + line)
        elif in_direction:
            if line == '':
                if dir_headers is None: dir_headers = []
                elif dir_rows is None: dir_rows = []
                else:
                    d['direction'][in_direction]['rows'] = dir_rows
                    in_direction = False
            elif dir_rows is None:
                if line.startswith('~'):
                    pattern = '^(' + line.replace('~','.').\
                        replace(' .',' (.').replace('. ','.) ')
                    if pattern[-1] == '.': pattern += ')'
                    dir_re = re.compile(pattern)
                    d['direction'][in_direction]['headers'] = list()
                    headers = list()
                    for h in dir_headers:
                        headers.append(
                            [x.strip() for x in dir_re.match(h).groups()])
                    for h in zip(*headers):
                        d['direction'][in_direction]['headers'].append(
                            [x for x in h if x])
                else:
                    dir_headers.append(line)
            else:
                dir_rows.append(
                    [x.strip() for x in dir_re.match(line).groups()])
            
        else:
            if linenum == 0: assert(line == 'Stop Trips')
            elif linenum == 1: assert(line == '~~~~~~~~~~')
            elif linenum == 2: 
                assert(line == '')
                in_header = True
            elif line.startswith('Direction:'):
                name, raw_val = line.split(':',1)
                val = raw_val.strip()
                assert(val in ('To Downtown', 'From Downtown'))
                d['direction'][val] = dict()
                in_direction = val
                dir_headers = None
                dir_rows = None
            elif line == '': continue
            else:
                raise ValueError('I have no idea where I am at line ' + linenum + '\n' + line)
            
    return d

# From Stoptrips/100_1.txt
st_100_1 = '''\
Stop Trips
~~~~~~~~~~

SignUp:       AUG 2011
Service:      1
Line:         100
Exception:    Off
Printed:      Jul 22, 2011  0:31+

Direction:    To Downtown

Pattern  INT  VAL      123Ar                                                                                                     Adm/MemE                                                                                          ADM/YAL                      Pitt4 th                                                                          LE3                                          3ROCK/WB                                                                               DAS1  
                    Arch124a   124aAdmC   Adm120a   FLAG34   Adm109a   Adm106p   Adm106p   FLAG42   Adm91av   Adm89av   Adm85av    AdmMem   Adm78av   Adm73av   Adm69av   Adm67av   AdmSher   AdmLkwd   AdmJop   AdmDar   AdmAlgh    AdmYa   AdmSand   PitAdm   Pitt4 th   4stLou   4stHarv   3stGary   3stEvan   3stColu   3stBmAv   3stAtl   3stLew   3stZuni   3stXanA   3stUtic   3stTren   3stRock   3stQuin   FLAG1   3stKeno   3stFkft   3stDet   3stCin   3stBos   Chey3st   DBAY1  
~~~~~~~  ~~~  ~~~  ~~~~~~~~~  ~~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~  

     01    I    V      6:00       6:00+     6:01+    6:03+     6:04+     6:04+     6:05+    6:07+     6:08+     6:08+     6:10+     6:11      6:11+     6:12+     6:13+     6:14+     6:14+     6:15+    6:16+    6:17+     6:17+    6:18      6:19+    6:21       6:23     6:23+     6:24+     6:25+     6:25+     6:26+     6:26+    6:27+    6:27+     6:28+     6:28+     6:29+     6:29+     6:30      6:30+   6:30+     6:32+     6:32+    6:33+    6:33+    6:34+     6:34+   6:35   
     01    I    V      6:45       6:45+     6:46+    6:48+     6:49+     6:49+     6:50+    6:52+     6:53+     6:53+     6:55+     6:56      6:56+     6:57+     6:58+     6:59+     6:59+     7:00+    7:01+    7:02+     7:02+    7:03      7:04+    7:06       7:08     7:08+     7:09+     7:10+     7:10+     7:11+     7:11+    7:12+    7:12+     7:13+     7:13+     7:14+     7:14+     7:15      7:15+   7:15+     7:17+     7:17+    7:18+    7:18+    7:19+     7:19+   7:20   
     01    I    V      7:30       7:30+     7:31+    7:33+     7:34+     7:34+     7:35+    7:37+     7:38+     7:38+     7:40+     7:41      7:41+     7:42+     7:43+     7:44+     7:44+     7:45+    7:46+    7:47+     7:47+    7:48      7:49+    7:51       7:53     7:53+     7:54+     7:55+     7:55+     7:56+     7:56+    7:57+    7:57+     7:58+     7:58+     7:59+     7:59+     8:00      8:00+   8:00+     8:02+     8:02+    8:03+    8:03+    8:04+     8:04+   8:05   
     01    I    V      8:15       8:15+     8:16+    8:18+     8:19+     8:19+     8:20+    8:22+     8:23+     8:23+     8:25+     8:26      8:26+     8:27+     8:28+     8:29+     8:29+     8:30+    8:31+    8:32+     8:32+    8:33      8:34+    8:36       8:38     8:38+     8:39+     8:40+     8:40+     8:41+     8:41+    8:42+    8:42+     8:43+     8:43+     8:44+     8:44+     8:45      8:45+   8:45+     8:47+     8:47+    8:48+    8:48+    8:49+     8:49+   8:50   
     01    I    V      9:00       9:00+     9:01+    9:03+     9:04+     9:04+     9:05+    9:07+     9:08+     9:08+     9:10+     9:11      9:11+     9:12+     9:13+     9:14+     9:14+     9:15+    9:16+    9:17+     9:17+    9:18      9:19+    9:21       9:23     9:23+     9:24+     9:25+     9:25+     9:26+     9:26+    9:27+    9:27+     9:28+     9:28+     9:29+     9:29+     9:30      9:30+   9:30+     9:32+     9:32+    9:33+    9:33+    9:34+     9:34+   9:35   
     01    I    V      9:45       9:45+     9:46+    9:48+     9:49+     9:49+     9:50+    9:52+     9:53+     9:53+     9:55+     9:56      9:56+     9:57+     9:58+     9:59+     9:59+    10:00+   10:01+   10:02+    10:02+   10:03     10:04+   10:06      10:08    10:08+    10:09+    10:10+    10:10+    10:11+    10:11+   10:12+   10:12+    10:13+    10:13+    10:14+    10:14+    10:15     10:15+  10:15+    10:17+    10:17+   10:18+   10:18+   10:19+    10:19+  10:20   
     01    I    V     10:30      10:30+    10:31+   10:33+    10:34+    10:34+    10:35+   10:37+    10:38+    10:38+    10:40+    10:41     10:41+    10:42+    10:43+    10:44+    10:44+    10:45+   10:46+   10:47+    10:47+   10:48     10:49+   10:51      10:53    10:53+    10:54+    10:55+    10:55+    10:56+    10:56+   10:57+   10:57+    10:58+    10:58+    10:59+    10:59+    11:00     11:00+  11:00+    11:02+    11:02+   11:03+   11:03+   11:04+    11:04+  11:05   
     01    I    V     11:15      11:15+    11:16+   11:18+    11:19+    11:19+    11:20+   11:22+    11:23+    11:23+    11:25+    11:26     11:26+    11:27+    11:28+    11:29+    11:29+    11:30+   11:31+   11:32+    11:32+   11:33     11:34+   11:36      11:38    11:38+    11:39+    11:40+    11:40+    11:41+    11:41+   11:42+   11:42+    11:43+    11:43+    11:44+    11:44+    11:45     11:45+  11:45+    11:47+    11:47+   11:48+   11:48+   11:49+    11:49+  11:50   
     01    I    V     12:00      12:00+    12:01+   12:03+    12:04+    12:04+    12:05+   12:07+    12:08+    12:08+    12:10+    12:11     12:11+    12:12+    12:13+    12:14+    12:14+    12:15+   12:16+   12:17+    12:17+   12:18     12:19+   12:21      12:23    12:23+    12:24+    12:25+    12:25+    12:26+    12:26+   12:27+   12:27+    12:28+    12:28+    12:29+    12:29+    12:30     12:30+  12:30+    12:32+    12:32+   12:33+   12:33+   12:34+    12:34+  12:35   
     01    I    V     12:45      12:45+    12:46+   12:48+    12:49+    12:49+    12:50+   12:52+    12:53+    12:53+    12:55+    12:56     12:56+    12:57+    12:58+    12:59+    12:59+    13:00+   13:01+   13:02+    13:02+   13:03     13:04+   13:06      13:08    13:08+    13:09+    13:10+    13:10+    13:11+    13:11+   13:12+   13:12+    13:13+    13:13+    13:14+    13:14+    13:15     13:15+  13:15+    13:17+    13:17+   13:18+   13:18+   13:19+    13:19+  13:20   
     01    I    V     13:30      13:30+    13:31+   13:33+    13:34+    13:34+    13:35+   13:37+    13:38+    13:38+    13:40+    13:41     13:41+    13:42+    13:43+    13:44+    13:44+    13:45+   13:46+   13:47+    13:47+   13:48     13:49+   13:51      13:53    13:53+    13:54+    13:55+    13:55+    13:56+    13:56+   13:57+   13:57+    13:58+    13:58+    13:59+    13:59+    14:00     14:00+  14:00+    14:02+    14:02+   14:03+   14:03+   14:04+    14:04+  14:05   
     01    I    V     14:15      14:15+    14:16+   14:18+    14:19+    14:19+    14:20+   14:22+    14:23+    14:23+    14:25+    14:26     14:26+    14:27+    14:28+    14:29+    14:29+    14:30+   14:31+   14:32+    14:32+   14:33     14:34+   14:36      14:38    14:38+    14:39+    14:40+    14:40+    14:41+    14:41+   14:42+   14:42+    14:43+    14:43+    14:44+    14:44+    14:45     14:45+  14:45+    14:47+    14:47+   14:48+   14:48+   14:49+    14:49+  14:50   
     01    I    V     15:00      15:00+    15:01+   15:03+    15:04+    15:04+    15:05+   15:07+    15:08+    15:08+    15:10+    15:11     15:11+    15:12+    15:13+    15:14+    15:14+    15:15+   15:16+   15:17+    15:17+   15:18     15:19+   15:21      15:23    15:23+    15:24+    15:25+    15:25+    15:26+    15:26+   15:27+   15:27+    15:28+    15:28+    15:29+    15:29+    15:30     15:30+  15:30+    15:32+    15:32+   15:33+   15:33+   15:34+    15:34+  15:35   
     01    I    V     15:45      15:45+    15:46+   15:48+    15:49+    15:49+    15:50+   15:52+    15:53+    15:53+    15:55+    15:56     15:56+    15:57+    15:58+    15:59+    15:59+    16:00+   16:01+   16:02+    16:02+   16:03     16:04+   16:06      16:08    16:08+    16:09+    16:10+    16:10+    16:11+    16:11+   16:12+   16:12+    16:13+    16:13+    16:14+    16:14+    16:15     16:15+  16:15+    16:17+    16:17+   16:18+   16:18+   16:19+    16:19+  16:20   
     01    I    V     16:30      16:30+    16:31+   16:33+    16:34+    16:34+    16:35+   16:37+    16:38+    16:38+    16:40+    16:41     16:41+    16:42+    16:43+    16:44+    16:44+    16:45+   16:46+   16:47+    16:47+   16:48     16:49+   16:51      16:53    16:53+    16:54+    16:55+    16:55+    16:56+    16:56+   16:57+   16:57+    16:58+    16:58+    16:59+    16:59+    17:00     17:00+  17:00+    17:02+    17:02+   17:03+   17:03+   17:04+    17:04+  17:05   
     01    I    V     17:15      17:15+    17:16+   17:18+    17:19+    17:19+    17:20+   17:22+    17:23+    17:23+    17:25+    17:26     17:26+    17:27+    17:28+    17:29+    17:29+    17:30+   17:31+   17:32+    17:32+   17:33     17:34+   17:36      17:38    17:38+    17:39+    17:40+    17:40+    17:41+    17:41+   17:42+   17:42+    17:43+    17:43+    17:44+    17:44+    17:45     17:45+  17:45+    17:47+    17:47+   17:48+   17:48+   17:49+    17:49+  17:50   
     01    I    V     18:00      18:00+    18:01+   18:03+    18:04+    18:04+    18:05+   18:07+    18:08+    18:08+    18:10+    18:11     18:11+    18:12+    18:13+    18:14+    18:14+    18:15+   18:16+   18:17+    18:17+   18:18     18:19+   18:21      18:23    18:23+    18:24+    18:25+    18:25+    18:26+    18:26+   18:27+   18:27+    18:28+    18:28+    18:29+    18:29+    18:30     18:30+  18:30+    18:32+    18:32+   18:33+   18:33+   18:34+    18:34+  18:35   
     01    I    V     18:45      18:45+    18:46+   18:48+    18:49+    18:49+    18:50+   18:52+    18:53+    18:53+    18:55+    18:56     18:56+    18:57+    18:58+    18:59+    18:59+    19:00+   19:01+   19:02+    19:02+   19:03     19:04+   19:06      19:08    19:08+    19:09+    19:10+    19:10+    19:11+    19:11+   19:12+   19:12+    19:13+    19:13+    19:14+    19:14+    19:15     19:15+  19:15+    19:17+    19:17+   19:18+   19:18+   19:19+    19:19+  19:20   


Direction:    From Downtown

Pattern  INT  VAL    DAS1                                                                     PE2SB                        3Ro                                                                                                                        Pitt4 th                        AdYa                                                                                                                AdMe                                                                                                       123Ar  
                    DBAY1   Dnvr3st   2stBld    2Cin   2stDet   2stFkft   2stGrnw   Peo1st   Peo2st   FLAG1   3stPeo   3stQuin   3stTren   3stUtic   3stXanA   3stLew   3stAtl   3stBmAv   3stColu   3stDel   3stColl   3stFlor   4stHarv   4plPitt   Pitt4 th   AdmSand   AdmUrba   AdmYa   AdmAlgh   AdmDar   AdmDar   AdmJop   AdmNwdA   AdmSher   Adm68av   Adm69av   Adm72av   Adm73av   Adm78av   AdmMem   AdmMem   Adm89av   Adm91av   FLAG43   Adm101a   Adm101a   Adm106p   FLAG41   AdmGntt   Adm117a   Arch124a  
~~~~~~~  ~~~  ~~~  ~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~  ~~~~~~~~  ~~~~~~~~  ~~~~~~~~~  

     01    I    V   5:55      5:55+    5:56+   5:56+    5:57+     5:57+     5:58+    6:00+    6:00+   6:01     6:01+     6:02      6:02+     6:02+     6:03+    6:04+    6:04+     6:05+     6:05+    6:05+     6:06+     6:06+     6:07+     6:08+      6:09      6:12+     6:12+   6:14      6:14+    6:14+    6:15+    6:16+     6:17      6:17+     6:17+     6:18+     6:18+     6:19+     6:20+    6:21     6:21+     6:22+     6:23+    6:25+     6:25+     6:26+     6:27+    6:28+     6:28+     6:30+      6:32   
     01    I    V   6:40      6:40+    6:41+   6:41+    6:42+     6:42+     6:43+    6:45+    6:45+   6:46     6:46+     6:47      6:47+     6:47+     6:48+    6:49+    6:49+     6:50+     6:50+    6:50+     6:51+     6:51+     6:52+     6:53+      6:54      6:57+     6:57+   6:59      6:59+    6:59+    7:00+    7:01+     7:02      7:02+     7:02+     7:03+     7:03+     7:04+     7:05+    7:06     7:06+     7:07+     7:08+    7:10+     7:10+     7:11+     7:12+    7:13+     7:13+     7:15+      7:17   
     01    I    V   7:25      7:25+    7:26+   7:26+    7:27+     7:27+     7:28+    7:30+    7:30+   7:31     7:31+     7:32      7:32+     7:32+     7:33+    7:34+    7:34+     7:35+     7:35+    7:35+     7:36+     7:36+     7:37+     7:38+      7:39      7:42+     7:42+   7:44      7:44+    7:44+    7:45+    7:46+     7:47      7:47+     7:47+     7:48+     7:48+     7:49+     7:50+    7:51     7:51+     7:52+     7:53+    7:55+     7:55+     7:56+     7:57+    7:58+     7:58+     8:00+      8:02   
     01    I    V   8:10      8:10+    8:11+   8:11+    8:12+     8:12+     8:13+    8:15+    8:15+   8:16     8:16+     8:17      8:17+     8:17+     8:18+    8:19+    8:19+     8:20+     8:20+    8:20+     8:21+     8:21+     8:22+     8:23+      8:24      8:27+     8:27+   8:29      8:29+    8:29+    8:30+    8:31+     8:32      8:32+     8:32+     8:33+     8:33+     8:34+     8:35+    8:36     8:36+     8:37+     8:38+    8:40+     8:40+     8:41+     8:42+    8:43+     8:43+     8:45+      8:47   
     01    I    V   8:55      8:55+    8:56+   8:56+    8:57+     8:57+     8:58+    9:00+    9:00+   9:01     9:01+     9:02      9:02+     9:02+     9:03+    9:04+    9:04+     9:05+     9:05+    9:05+     9:06+     9:06+     9:07+     9:08+      9:09      9:12+     9:12+   9:14      9:14+    9:14+    9:15+    9:16+     9:17      9:17+     9:17+     9:18+     9:18+     9:19+     9:20+    9:21     9:21+     9:22+     9:23+    9:25+     9:25+     9:26+     9:27+    9:28+     9:28+     9:30+      9:32   
     01    I    V   9:40      9:40+    9:41+   9:41+    9:42+     9:42+     9:43+    9:45+    9:45+   9:46     9:46+     9:47      9:47+     9:47+     9:48+    9:49+    9:49+     9:50+     9:50+    9:50+     9:51+     9:51+     9:52+     9:53+      9:54      9:57+     9:57+   9:59      9:59+    9:59+   10:00+   10:01+    10:02     10:02+    10:02+    10:03+    10:03+    10:04+    10:05+   10:06    10:06+    10:07+    10:08+   10:10+    10:10+    10:11+    10:12+   10:13+    10:13+    10:15+     10:17   
     01    I    V  10:25     10:25+   10:26+  10:26+   10:27+    10:27+    10:28+   10:30+   10:30+  10:31    10:31+    10:32     10:32+    10:32+    10:33+   10:34+   10:34+    10:35+    10:35+   10:35+    10:36+    10:36+    10:37+    10:38+     10:39     10:42+    10:42+  10:44     10:44+   10:44+   10:45+   10:46+    10:47     10:47+    10:47+    10:48+    10:48+    10:49+    10:50+   10:51    10:51+    10:52+    10:53+   10:55+    10:55+    10:56+    10:57+   10:58+    10:58+    11:00+     11:02   
     01    I    V  11:10     11:10+   11:11+  11:11+   11:12+    11:12+    11:13+   11:15+   11:15+  11:16    11:16+    11:17     11:17+    11:17+    11:18+   11:19+   11:19+    11:20+    11:20+   11:20+    11:21+    11:21+    11:22+    11:23+     11:24     11:27+    11:27+  11:29     11:29+   11:29+   11:30+   11:31+    11:32     11:32+    11:32+    11:33+    11:33+    11:34+    11:35+   11:36    11:36+    11:37+    11:38+   11:40+    11:40+    11:41+    11:42+   11:43+    11:43+    11:45+     11:47   
     01    I    V  11:55     11:55+   11:56+  11:56+   11:57+    11:57+    11:58+   12:00+   12:00+  12:01    12:01+    12:02     12:02+    12:02+    12:03+   12:04+   12:04+    12:05+    12:05+   12:05+    12:06+    12:06+    12:07+    12:08+     12:09     12:12+    12:12+  12:14     12:14+   12:14+   12:15+   12:16+    12:17     12:17+    12:17+    12:18+    12:18+    12:19+    12:20+   12:21    12:21+    12:22+    12:23+   12:25+    12:25+    12:26+    12:27+   12:28+    12:28+    12:30+     12:32   
     01    I    V  12:40     12:40+   12:41+  12:41+   12:42+    12:42+    12:43+   12:45+   12:45+  12:46    12:46+    12:47     12:47+    12:47+    12:48+   12:49+   12:49+    12:50+    12:50+   12:50+    12:51+    12:51+    12:52+    12:53+     12:54     12:57+    12:57+  12:59     12:59+   12:59+   13:00+   13:01+    13:02     13:02+    13:02+    13:03+    13:03+    13:04+    13:05+   13:06    13:06+    13:07+    13:08+   13:10+    13:10+    13:11+    13:12+   13:13+    13:13+    13:15+     13:17   
     01    I    V  13:25     13:25+   13:26+  13:26+   13:27+    13:27+    13:28+   13:30+   13:30+  13:31    13:31+    13:32     13:32+    13:32+    13:33+   13:34+   13:34+    13:35+    13:35+   13:35+    13:36+    13:36+    13:37+    13:38+     13:39     13:42+    13:42+  13:44     13:44+   13:44+   13:45+   13:46+    13:47     13:47+    13:47+    13:48+    13:48+    13:49+    13:50+   13:51    13:51+    13:52+    13:53+   13:55+    13:55+    13:56+    13:57+   13:58+    13:58+    14:00+     14:02   
     01    I    V  14:10     14:10+   14:11+  14:11+   14:12+    14:12+    14:13+   14:15+   14:15+  14:16    14:16+    14:17     14:17+    14:17+    14:18+   14:19+   14:19+    14:20+    14:20+   14:20+    14:21+    14:21+    14:22+    14:23+     14:24     14:27+    14:27+  14:29     14:29+   14:29+   14:30+   14:31+    14:32     14:32+    14:32+    14:33+    14:33+    14:34+    14:35+   14:36    14:36+    14:37+    14:38+   14:40+    14:40+    14:41+    14:42+   14:43+    14:43+    14:45+     14:47   
     01    I    V  14:55     14:55+   14:56+  14:56+   14:57+    14:57+    14:58+   15:00+   15:00+  15:01    15:01+    15:02     15:02+    15:02+    15:03+   15:04+   15:04+    15:05+    15:05+   15:05+    15:06+    15:06+    15:07+    15:08+     15:09     15:12+    15:12+  15:14     15:14+   15:14+   15:15+   15:16+    15:17     15:17+    15:17+    15:18+    15:18+    15:19+    15:20+   15:21    15:21+    15:22+    15:23+   15:25+    15:25+    15:26+    15:27+   15:28+    15:28+    15:30+     15:32   
     01    I    V  15:40     15:40+   15:41+  15:41+   15:42+    15:42+    15:43+   15:45+   15:45+  15:46    15:46+    15:47     15:47+    15:47+    15:48+   15:49+   15:49+    15:50+    15:50+   15:50+    15:51+    15:51+    15:52+    15:53+     15:54     15:57+    15:57+  15:59     15:59+   15:59+   16:00+   16:01+    16:02     16:02+    16:02+    16:03+    16:03+    16:04+    16:05+   16:06    16:06+    16:07+    16:08+   16:10+    16:10+    16:11+    16:12+   16:13+    16:13+    16:15+     16:17   
     01    I    V  16:25     16:25+   16:26+  16:26+   16:27+    16:27+    16:28+   16:30+   16:30+  16:31    16:31+    16:32     16:32+    16:32+    16:33+   16:34+   16:34+    16:35+    16:35+   16:35+    16:36+    16:36+    16:37+    16:38+     16:39     16:42+    16:42+  16:44     16:44+   16:44+   16:45+   16:46+    16:47     16:47+    16:47+    16:48+    16:48+    16:49+    16:50+   16:51    16:51+    16:52+    16:53+   16:55+    16:55+    16:56+    16:57+   16:58+    16:58+    17:00+     17:02   
     01    I    V  17:10     17:10+   17:11+  17:11+   17:12+    17:12+    17:13+   17:15+   17:15+  17:16    17:16+    17:17     17:17+    17:17+    17:18+   17:19+   17:19+    17:20+    17:20+   17:20+    17:21+    17:21+    17:22+    17:23+     17:24     17:27+    17:27+  17:29     17:29+   17:29+   17:30+   17:31+    17:32     17:32+    17:32+    17:33+    17:33+    17:34+    17:35+   17:36    17:36+    17:37+    17:38+   17:40+    17:40+    17:41+    17:42+   17:43+    17:43+    17:45+     17:47   
     01    I    V  17:55     17:55+   17:56+  17:56+   17:57+    17:57+    17:58+   18:00+   18:00+  18:01    18:01+    18:02     18:02+    18:02+    18:03+   18:04+   18:04+    18:05+    18:05+   18:05+    18:06+    18:06+    18:07+    18:08+     18:09     18:12+    18:12+  18:14     18:14+   18:14+   18:15+   18:16+    18:17     18:17+    18:17+    18:18+    18:18+    18:19+    18:20+   18:21    18:21+    18:22+    18:23+   18:25+    18:25+    18:26+    18:27+   18:28+    18:28+    18:30+     18:32   
     01    I    V  18:40     18:40+   18:41+  18:41+   18:42+    18:42+    18:43+   18:45+   18:45+  18:46    18:46+    18:47     18:47+    18:47+    18:48+   18:49+   18:49+    18:50+    18:50+   18:50+    18:51+    18:51+    18:52+    18:53+     18:54     18:57+    18:57+  18:59     18:59+   18:59+   19:00+   19:01+    19:02     19:02+    19:02+    19:03+    19:03+    19:04+    19:05+   19:06    19:06+    19:07+    19:08+   19:10+    19:10+    19:11+    19:12+   19:13+    19:13+    19:15+     19:17   


'''

if __name__ == '__main__':
    data = parse_trapeze_text(st_100_1)
    import pprint
    pprint.pprint(data)